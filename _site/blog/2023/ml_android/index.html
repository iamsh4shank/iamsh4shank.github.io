<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Deploying a PyTorch ML model in an Android app | Shashank  Priyadarshi</title>
    <meta name="author" content="Shashank  Priyadarshi">
    <meta name="description" content="Integration of a computer vision model built in PyTorch with an Android app">
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700%7CRoboto+Slab:100,300,400,500,700%7CMaterial+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    <!-- Styles -->
    
    <link rel="shortcut icon" href="/assets/img/android-chrome-512x512.png">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="http://localhost:4000/blog/2023/ml_android/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
       <script type="text/x-mathjax-config">
         MathJax.Hub.Config({
           tex2jax: {
             inlineMath: [ ['$','$'], ["\\(","\\)"] ],
             processEscapes: true
           }
         });
       </script>
       <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Shashank </span>Priyadarshi</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item active">
                <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a>
              </li>

              <!-- CV -->
              <li class="nav-item ">
                <a class="nav-link" href="https://iamsh4shank.github.io/docs/cv.pdf" rel="external nofollow noopener" target="_blank">cv
                </a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/experience/">experience</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/repositories/">repositories</a>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      <!-- _layouts/post.html -->

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Deploying a PyTorch ML model in an Android app</h1>
    <p class="post-meta">January 28, 2023</p>
    <p class="post-tags">
      <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>
        ·  
        <a href="/blog/tag/machine-learning">
          <i class="fas fa-hashtag fa-sm"></i> machine-learning</a>  
          <a href="/blog/tag/research">
          <i class="fas fa-hashtag fa-sm"></i> research</a>  
          
        ·  
        <a href="/blog/category/learnings">
          <i class="fas fa-tag fa-sm"></i> learnings</a>  
          

    </p>
  </header>

  <article class="post-content">
    <p>Integration of a computer vision model built in PyTorch with an Android app can be a powerful way to bring the capabilities of machine learning to mobile devices. In this blog post, we will go over the steps needed to integrate a PyTorch model into an Android app and run inferences on the device. This integration will allow us the development of more advanced and intelligent mobile apps. ML can enable features such as image and speech recognition, natural language processing, and predictive analytics, which can enhance the user experience and make the app more efficient and effective. Additionally, integrating ML with Android can enable offline functionality, which is important for apps that need to work in areas with limited or no internet connectivity. Furthermore, with the growing amount of data generated by mobile devices, integrating machine learning models allows for more efficient and accurate data analysis.</p>

<p>Today we’re going to learn how to integrate a Machine Learning model into an Android App. So the idea is - 
We are going to create an app that let you add a picture from your gallery and further tells you which type of Tomato it is using the <a href="https://universe.roboflow.com/labeler-projects/tomato-classification-jc5kz" rel="external nofollow noopener" target="_blank">Tomato classification dataset</a>. A tomato classification model could be used in precision agriculture to pick tomatoes with the correct ripeness, pick certain types of tomatoes, sort tomatoes once they have been picked, serve as input for overall crop growth or crop health, and more.</p>

<p>We can divide this blog into some sub-parts -</p>
<ol>
  <li>Developing an Android App</li>
  <li>Creating a classifier</li>
  <li>Integrating the model within the App</li>
  <li>Testing the app</li>
</ol>

<p>So let’s get started, but before that let’s first get a basic introduction to android and how to design apps -</p>

<h2 id="developing-an-android-app">Developing an Android App</h2>

<h4 id="guide-to-start-with-android-development--">Guide to start with Android Development -</h4>
<p>This is a beginner guide to start making android apps, skip if you already know how to make one.</p>

<ul>
  <li>Installing Android Studio - To install android studio you can follow the steps given in this link based on the operating system.</li>
  <li>If you are new to Android Development then you can learn from several online resources, a few of them that I used are -</li>
  <li>Android Basics in Kotlin</li>
  <li>Codelabs for Android Developer Fundamentals</li>
  <li>Or any course, resources, or documentation of your choice</li>
  <li>Next, you are ready to make an Android app</li>
</ul>

<h2 id="creating-a-classifier">Creating a Classifier</h2>

<p>So, in this case, we’re using the <a href="https://blog.roboflow.com/yolov5-improvements-and-evaluation/" rel="external nofollow noopener" target="_blank">YOLOv5</a> classification model to perform the classification of the Tomatoes. To train your own model you can take the reference on how to train <a href="https://blog.roboflow.com/train-yolov5-classification-custom-data/" rel="external nofollow noopener" target="_blank">YOLOv5-Classification</a> on a Custom dataset. You can use any classification <a href="https://roboflow.com/models" rel="external nofollow noopener" target="_blank">model</a> or custom dataset for this task. Feel free to follow along with the same dataset or find another dataset in <a href="https://universe.roboflow.com/" rel="external nofollow noopener" target="_blank">Universe</a> (a community of 66M+ open-source images) to use if you don’t already have your own data.</p>

<h2 id="integrating-the-model-within-the-app">Integrating the model within the App</h2>

<p>Hope you trained your model, before going to the next steps let’s do a quick review to see how we create the model deployable in an android app. A few common examples are you can use PyTorch models or TensorFlow models by converting them to the correct format such as you can directly use a .pt models using <a href="https://pytorch.org/mobile/android/#quickstart-with-a-helloworld-example" rel="external nofollow noopener" target="_blank">PyTorch Mobile</a> or you can convert them to TensorFlow Lite format by first converting PyTorch to ONXX (by using <a href="https://pytorch.org/docs/stable/onnx.html" rel="external nofollow noopener" target="_blank">torch.onxx</a> and <a href="https://pytorch.org/tutorials/advanced/super_resolution_with_onnxruntime.html" rel="external nofollow noopener" target="_blank">this</a>) and then converting ONNX to TensorFlow using <a href="https://github.com/onnx/onnx-tensorflow" rel="external nofollow noopener" target="_blank">onnx-tensorflow</a> (v1.10.0).</p>

<p>In our case, we are using the first method i.e. using the PyTorch Android API. So the few steps that are required are as follows -</p>

<ul>
  <li>
<strong>Model Preparation -</strong>
As you already created the classification model (YOLOv5) then the next step is to serialize the model using this script to prepare the mobile interpreter version of the model.</li>
</ul>

<pre><code class="language-Python">import torch
import torchvision
from torch.utils.mobile_optimizer import optimize_for_mobile

# In case you are using pretrained model you can use this
#model = torchvision.models.mobilenet_v2(pretrained=True)

# As in our case we have the best model assuming that you trained using the previous blog
model = torch.hub.load('/content/yolov5', 'custom', path = 'runs/train-cls/exp/weights/best.pt', source = 'local')

#based on input we’ll create a dummy example
dummy_example = torch.rand(1, 3, 224, 224)


torchscript_model = torch.jit.trace(model, dummy_example)

# Export mobile interpreter version model
torchscript_model_optimized = optimize_for_mobile(torchscript_model)
torchscript_model_optimized._save_for_lite_interpreter("/content/model.pt")
</code></pre>

<ul>
  <li>
<strong>Create the app -</strong>
In this case, you can start with an Empty Activity (or choose based on your project level/features) and name the app as TomatoApp.</li>
</ul>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="https://i.imgur.com/sZx4vAw-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="https://i.imgur.com/sZx4vAw-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="https://i.imgur.com/sZx4vAw-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="https://i.imgur.com/sZx4vAw.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="https://i.imgur.com/dtpXcgs-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="https://i.imgur.com/dtpXcgs-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="https://i.imgur.com/dtpXcgs-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="https://i.imgur.com/dtpXcgs.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
</div>

<p>Our app contains a main activity that handles two buttons -</p>
<ul>
  <li>Upload Button -&gt; To let you upload an image from the local storage</li>
  <li>Predict Button -&gt; To predict the class of the Tomato
and one ImageView that will show you the selected image. The app may vary based on your need.</li>
</ul>

<div class="text-center">
    <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="https://i.imgur.com/DVPx5O5-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="https://i.imgur.com/DVPx5O5-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="https://i.imgur.com/DVPx5O5-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="https://i.imgur.com/DVPx5O5.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

</div>

<ul>
  <li>
<strong>Modifying Gradle dependencies -</strong>
Next we need to add the PyTorch android in the Android app gradle dependencies -</li>
</ul>

<p>On the <a href="https://github.com/iamsh4shank/TomatoClassifier/blob/main/app/build.gradle#L37-L38" rel="external nofollow noopener" target="_blank">App Level</a> -</p>

<pre><code class="language-Java">implementation 'org.pytorch:pytorch_android_lite:1.13.0'
implementation 'org.pytorch:pytorch_android_torchvision_lite:1.13.0'
</code></pre>

<p>On the <a href="https://github.com/iamsh4shank/TomatoClassifier/blob/main/build.gradle#L6" rel="external nofollow noopener" target="_blank">Project Level</a> -</p>

<pre><code class="language-Java">repositories {
   jcenter()
}
</code></pre>

<ul>
  <li><strong>Adding the model to the asset file, adding the classes, and Reading the image -</strong></li>
</ul>

<p>Next step is to add the model to the asset folder inside your app. For this you need to create an asset folder, you can do this by following this -</p>

<p>Right-click on <strong>app</strong> -&gt; New -&gt; Directory -&gt; write asset -&gt; select src/main/assets</p>

<p>Nice, you created the <a href="https://github.com/iamsh4shank/TomatoClassifier/tree/main/app/src/main/assets" rel="external nofollow noopener" target="_blank">assets</a> folder, next put your model inside this folder. Next, as our plan is to pick an image from the storage, in this case first used the custom method to select an image and then override the onActivityResult, if the user selected an image then it will forward to the next step of using our model.</p>

<p>We also need to add the classes/labels for the classification task, for this we need to add a Constants.java file. Follow these steps to do it -</p>

<p>Right-click on <strong>com.example.tomatoapp</strong> -&gt; New -&gt; Java class -&gt; Write Constant.java and enter</p>

<p>Cool, now you have the file ready, inside the class Constants add the classes as follows:</p>

<pre><code class="language-Java">public static String[] TOMATO_CLASSES = new String[]{
       "Maroon Tomato",
       "Red Cherry Tomato",
       "Red Large Tomato",
       "Red Tomato",
       "Walnut",
       "Yellow Tomato"
};
</code></pre>

<p>Now we’ll read the selected image to android.graphics.Bitmap using the standard Android API.</p>
<pre><code class="language-Java">// you can use this if you are using some image from the assets folder
// Bitmap bitmap = BitmapFactory.decodeSystem(getAssets().open(“img_name.jpg”))
// in our case we are using the selected image from filePath
Bitmap bitmap = MediaStore.Images.Media.getBitmap(getContentResolver(), filePath)

</code></pre>

<ul>
  <li>
<strong>Loading Mobile Module and preparing the Input</strong>
To load model we’ll use LiteModuleLoader API of PyTorch Mobile</li>
</ul>

<pre><code class="language-Java">// assetFilePath is just a method to get absolute path
Module module = LiteModuleLoader.load(assetFilePath(this, “model.pt”))
</code></pre>
<p>For preparing input to follow this step</p>

<pre><code class="language-Java">Tensor inputTensor = TensorImageUtils.bitmapToFloat32Tensor(bitmap,
    TensorImageUtils.TORCHVISION_NORM_MEAN_RGB,                                            TensorImageUtils.TORCHVISION_NORM_STD_RGB);
</code></pre>
<p>Here the images that have to be loaded are in a range of [0, 1] and then normalized using mean = [0.485, 0.456, 0.406] and std = [0.229 0.224, 0.225]</p>

<ul>
  <li>
<strong>Run inference and predict the results -</strong>
Here we’ll use the forward method of PyTorch Mobile API and further use getDataAsFloatArray() to retrieve scores for every class of our dataset -
    <pre><code class="language-Java">// Running the model
Tensor outputTensor = module.forward(IValue.from(inputTensor)).toTensor();
// getting tensor content as a java array
float[] scores = outputTensor.getDataAsFloatArray();
</code></pre>
    <p>Next for getting the prediction we’ll just find the index that has a maximum score and return it as a class. Here have a look at it -</p>
    <pre><code class="language-Java">float maxScore = -Float.MAX_VALUE;
int maxScoreIdx = -1;
for (int i = 0; i &lt; scores.length; i++) {
if (scores[i] &gt; maxScore) {
  maxScore = scores[i];
  maxScoreIdx = i;
}
}
// we will just use this index to get the class name through the array that we // created
String className =com.example.tomatoapp.Constants.TOMATO_CLASSES[maxScoreIdx];
</code></pre>
  </li>
  <li>
<strong>Show it to the screen-</strong>
Now that we have the className, next we will just show it to the screen using a TextView by using setText() method of Android.</li>
</ul>

<h2 id="testing-the-app">Testing the app</h2>
<p>Now test the app using different images that you have in your local storage. Also, make the necessary in the app based on your need.</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="https://i.imgur.com/2PiG0oQ-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="https://i.imgur.com/2PiG0oQ-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="https://i.imgur.com/2PiG0oQ-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="https://i.imgur.com/2PiG0oQ.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="https://i.imgur.com/DVPx5O5-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="https://i.imgur.com/DVPx5O5-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="https://i.imgur.com/DVPx5O5-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="https://i.imgur.com/DVPx5O5.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
        <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    
    <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="https://i.imgur.com/WJv5cvj-480.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="https://i.imgur.com/WJv5cvj-800.webp"></source>
    <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="https://i.imgur.com/WJv5cvj-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img src="https://i.imgur.com/WJv5cvj.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
</div>

<p>Congratulations!! You just made your first app integrated with an ML model. Luckily this app is open source so you can look at the actual code here in the GitHub <a href="https://github.com/iamsh4shank/TomatoClassifier" rel="external nofollow noopener" target="_blank">repository</a>. So if you’re stuck somewhere do check out the actual implementation. Now it’s time to make some fun apps based on your need, it can be detecting objects near you using an android app, or it can be any other ML model. Once done you can ship the app and distribute it through the Google Play Store or another app distribution platform.</p>

  </article>


  
    
    <br>
    <hr>
    <br>
    <ul class="list-disc pl-8"></ul>

    <!-- Adds related posts to the end of an article -->
    <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2>
    <p class="mb-2">Here are some more articles you might like to read next:</p>
  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/ml_android/">Deploying a PyTorch ML model in an Android app</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/part1-a_ml/">Introduction to Adversarial ML</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/part5-nn-and-dl/">Part 5 - Gradient Descent and Backpropagation</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/year-review_2023/">Redefining Normal: A Year of Changes and Challenges in 2023</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/part2-nn-and-dl/">Part 2 - Neural Networks and Deep Learning</a>
  </li>

</div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2024 Shashank  Priyadarshi. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script defer src="/assets/js/common.js"></script>
  <script defer src="/assets/js/copy_code.js" type="text/javascript"></script>

    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>
  <script async src="https://badge.dimensions.ai/badge.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
